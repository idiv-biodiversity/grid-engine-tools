package        = @PACKAGE_NAME@
version        = @PACKAGE_VERSION@

prefix         = @prefix@
exec_prefix    = @exec_prefix@
bindir         = @bindir@
datarootdir    = @datarootdir@
datadir        = @datadir@
pkgdatadir     = ${datadir}/@PACKAGE_NAME@

default: scripts

all: scripts

deps: $(SGE_ROOT)/lib/jgdi.jar
	mkdir -p lib
	ln -s -f -t lib $(SGE_ROOT)/lib/jgdi.jar

scripts: export PREFIX = $(prefix)
scripts: deps
	sbt scripts

install: scripts
	install -Dm644 assembly/$(package).jar $(DESTDIR)$(pkgdatadir)/$(package).jar
	for script in $(notdir $(basename $(wildcard src/main/bash/*))) ; do \
	  install -Dm755 src/main/bash/$$script.sh $(DESTDIR)$(bindir)/$$script ; \
	done
	for script in $(notdir $(basename $(wildcard target/scripts/*))) ; do \
	  install -Dm755 target/scripts/$$script $(DESTDIR)$(bindir)/$$script ; \
	done
	install -Dm644 LICENSE $(DESTDIR)$(pkgdatadir)/LICENSE
	install -Dm644 NOTICE.md $(DESTDIR)$(pkgdatadir)/NOTICE.md

clean:
	rm -rf assembly lib project/project project/target target

.PHONY: all clean default deps install scripts
